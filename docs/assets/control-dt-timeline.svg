<svg width="900" height="400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .env-label { font: 14px 'Arial', sans-serif; font-weight: bold; }
      .control-step-label { font: 16px 'Arial', sans-serif; font-weight: bold; }
      .physics-step-label { font: 12px 'Arial', sans-serif; }
      .title { font: 18px 'Arial', sans-serif; font-weight: bold; }
      .explanation { font: 11px 'Arial', sans-serif; }
      .standard-step { fill: #4A90E2; stroke: #2E5C8A; stroke-width: 1; }
      .reset-driver { fill: #B73E32; stroke: #8B2F24; stroke-width: 1; }
      .reset-follower { fill: #F8B2B2; stroke: #E6999A; stroke-width: 1; }
      .reset-driver-highlight { fill: #B73E32; stroke: #8B2F24; stroke-width: 3; }
      .grid-line { stroke: #E0E0E0; stroke-width: 1; }
      .separator { stroke: #333; stroke-width: 2; }
    </style>
  </defs>

  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" class="title">Control_dt Measurement: Parallel Simulation Constraint</text>

  <!-- Subtitle -->
  <text x="400" y="45" text-anchor="middle" class="explanation">ALL environments execute identical physics step count every control cycle (GPU parallel constraint)</text>

  <!-- Grid lines -->
  <line x1="80" y1="60" x2="80" y2="320" class="separator"/>
  <line x1="320" y1="60" x2="320" y2="320" class="separator"/>
  <line x1="560" y1="60" x2="560" y2="320" class="separator"/>
  <line x1="800" y1="60" x2="800" y2="320" class="separator"/>

  <!-- Horizontal grid lines -->
  <line x1="80" y1="100" x2="800" y2="100" class="grid-line"/>
  <line x1="80" y1="160" x2="800" y2="160" class="grid-line"/>
  <line x1="80" y1="220" x2="800" y2="220" class="grid-line"/>
  <line x1="80" y1="280" x2="800" y2="280" class="grid-line"/>

  <!-- Environment labels -->
  <text x="20" y="85" class="env-label">Env 0</text>
  <text x="20" y="145" class="env-label">Env 1</text>
  <text x="20" y="205" class="env-label">Env 2</text>
  <text x="20" y="265" class="env-label">Env 3</text>

  <!-- Control step labels -->
  <text x="200" y="350" text-anchor="middle" class="control-step-label">Control Step 1</text>
  <text x="440" y="350" text-anchor="middle" class="control-step-label">Control Step 2</text>
  <text x="680" y="350" text-anchor="middle" class="control-step-label">Control Step 3</text>

  <!-- Control Step 1: Env 0 drives reset, others are parallel followers -->
  <!-- Env 0 - RESET DRIVER -->
  <rect x="85" y="65" width="55" height="30" class="standard-step"/>
  <text x="112" y="83" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="145" y="65" width="55" height="30" class="reset-driver-highlight"/>
  <text x="172" y="83" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="205" y="65" width="55" height="30" class="reset-driver-highlight"/>
  <text x="232" y="83" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="265" y="65" width="55" height="30" class="reset-driver-highlight"/>
  <text x="292" y="83" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 1 - PARALLEL FOLLOWER -->
  <rect x="85" y="125" width="55" height="30" class="standard-step"/>
  <text x="112" y="143" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="145" y="125" width="55" height="30" class="reset-follower"/>
  <text x="172" y="143" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="205" y="125" width="55" height="30" class="reset-follower"/>
  <text x="232" y="143" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="265" y="125" width="55" height="30" class="reset-follower"/>
  <text x="292" y="143" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 2 - PARALLEL FOLLOWER -->
  <rect x="85" y="185" width="55" height="30" class="standard-step"/>
  <text x="112" y="203" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="145" y="185" width="55" height="30" class="reset-follower"/>
  <text x="172" y="203" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="205" y="185" width="55" height="30" class="reset-follower"/>
  <text x="232" y="203" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="265" y="185" width="55" height="30" class="reset-follower"/>
  <text x="292" y="203" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 3 - PARALLEL FOLLOWER -->
  <rect x="85" y="245" width="55" height="30" class="standard-step"/>
  <text x="112" y="263" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="145" y="245" width="55" height="30" class="reset-follower"/>
  <text x="172" y="263" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="205" y="245" width="55" height="30" class="reset-follower"/>
  <text x="232" y="263" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="265" y="245" width="55" height="30" class="reset-follower"/>
  <text x="292" y="263" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Control Step 2: Env 1 drives reset, others are parallel followers -->
  <!-- Env 0 - PARALLEL FOLLOWER -->
  <rect x="325" y="65" width="55" height="30" class="standard-step"/>
  <text x="352" y="83" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="385" y="65" width="55" height="30" class="reset-follower"/>
  <text x="412" y="83" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="445" y="65" width="55" height="30" class="reset-follower"/>
  <text x="472" y="83" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="505" y="65" width="55" height="30" class="reset-follower"/>
  <text x="532" y="83" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 1 - RESET DRIVER -->
  <rect x="325" y="125" width="55" height="30" class="standard-step"/>
  <text x="352" y="143" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="385" y="125" width="55" height="30" class="reset-driver-highlight"/>
  <text x="412" y="143" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="445" y="125" width="55" height="30" class="reset-driver-highlight"/>
  <text x="472" y="143" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="505" y="125" width="55" height="30" class="reset-driver-highlight"/>
  <text x="532" y="143" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 2 - PARALLEL FOLLOWER -->
  <rect x="325" y="185" width="55" height="30" class="standard-step"/>
  <text x="352" y="203" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="385" y="185" width="55" height="30" class="reset-follower"/>
  <text x="412" y="203" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="445" y="185" width="55" height="30" class="reset-follower"/>
  <text x="472" y="203" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="505" y="185" width="55" height="30" class="reset-follower"/>
  <text x="532" y="203" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 3 - PARALLEL FOLLOWER -->
  <rect x="325" y="245" width="55" height="30" class="standard-step"/>
  <text x="352" y="263" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="385" y="245" width="55" height="30" class="reset-follower"/>
  <text x="412" y="263" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="445" y="245" width="55" height="30" class="reset-follower"/>
  <text x="472" y="263" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="505" y="245" width="55" height="30" class="reset-follower"/>
  <text x="532" y="263" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Control Step 3: No environments need reset, but deterministic timing maintains 4 steps -->
  <!-- Env 0 - ALL PARALLEL FOLLOWERS (no reset driver) -->
  <rect x="565" y="65" width="55" height="30" class="standard-step"/>
  <text x="592" y="83" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="625" y="65" width="55" height="30" class="reset-follower"/>
  <text x="652" y="83" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="685" y="65" width="55" height="30" class="reset-follower"/>
  <text x="712" y="83" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="745" y="65" width="55" height="30" class="reset-follower"/>
  <text x="772" y="83" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 1 - ALL PARALLEL FOLLOWERS -->
  <rect x="565" y="125" width="55" height="30" class="standard-step"/>
  <text x="592" y="143" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="625" y="125" width="55" height="30" class="reset-follower"/>
  <text x="652" y="143" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="685" y="125" width="55" height="30" class="reset-follower"/>
  <text x="712" y="143" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="745" y="125" width="55" height="30" class="reset-follower"/>
  <text x="772" y="143" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 2 - ALL PARALLEL FOLLOWERS -->
  <rect x="565" y="185" width="55" height="30" class="standard-step"/>
  <text x="592" y="203" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="625" y="185" width="55" height="30" class="reset-follower"/>
  <text x="652" y="203" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="685" y="185" width="55" height="30" class="reset-follower"/>
  <text x="712" y="203" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="745" y="185" width="55" height="30" class="reset-follower"/>
  <text x="772" y="203" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Env 3 - ALL PARALLEL FOLLOWERS -->
  <rect x="565" y="245" width="55" height="30" class="standard-step"/>
  <text x="592" y="263" text-anchor="middle" class="physics-step-label">P₁</text>
  <rect x="625" y="245" width="55" height="30" class="reset-follower"/>
  <text x="652" y="263" text-anchor="middle" class="physics-step-label">P₂</text>
  <rect x="685" y="245" width="55" height="30" class="reset-follower"/>
  <text x="712" y="263" text-anchor="middle" class="physics-step-label">P₃</text>
  <rect x="745" y="245" width="55" height="30" class="reset-follower"/>
  <text x="772" y="263" text-anchor="middle" class="physics-step-label">P₄</text>

  <!-- Legend -->
  <rect x="40" y="370" width="20" height="12" class="standard-step"/>
  <text x="65" y="380" class="explanation">P₁: Standard env.step() - all envs need this</text>

  <rect x="280" y="370" width="20" height="12" class="reset-driver"/>
  <text x="305" y="380" class="explanation">P₂-P₄: Reset driver - actually needs these steps</text>

  <rect x="540" y="370" width="20" height="12" class="reset-follower"/>
  <text x="565" y="380" class="explanation">P₂-P₄: Parallel follower - architectural overhead</text>

  <rect x="780" y="370" width="20" height="12" class="reset-driver-highlight"/>
  <text x="805" y="380" class="explanation">Thick border = Reset driver</text>

  <!-- Key insight callout -->
  <text x="450" y="395" text-anchor="middle" class="explanation" font-weight="bold">
    DETERMINISTIC TIMING: All environments execute identical physics steps for consistency
  </text>
</svg>
